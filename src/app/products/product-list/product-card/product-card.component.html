<div class="card">
  @if (isEditMode) {
    <form (ngSubmit)="onSubmit()" #productForm='ngForm'>
      <label>Name:
        <input type="text" [(ngModel)]="product.name" name="name" required #name='ngModel'>
      </label>
      <div [hidden]="name.valid || (name.pristine && name.untouched)"
           class="alert alert-danger">
        Name is required
      </div>
      <label>Description (optional):
        <input [(ngModel)]="product.description" type="text" name="description">
      </label>
      <label>Price:
        <input type="number" name="price" min="1" max="10000" required [(ngModel)]="product.price" #price='ngModel'>
      </label>
      <div [hidden]="price.valid || (price.pristine && price.untouched)"
           class="alert alert-danger">
        Price is required and in range 1 to 10000
      </div>
      <label>Tags (optional):
        <select (change)="addTag($event)" #tagSelect>
          @if (tags.length) {
            <option value="-1" disabled selected>Select tag</option>
          } @else {
            <option value="-1" disabled selected>No available tags</option>
          }
          @for (tag of tags;track tag.id) {
            <option value="{{tag.name}}" [disabled]="getIsDisabled(tag.name)">{{ tag.name }}</option>
          }
        </select>
      </label>
      @if (selectedTags.length) {
        <div>Selected Tags:
          @for (tagName of selectedTags;track tagName) {
            <p (click)="removeTag(tagName)">x {{ tagName }}</p>
          }
        </div>
      }
      <button type="submit" [disabled]="!productForm.form.valid">Save Edit</button>
      <button (click)="toggleEditForm()">Close Edit Mode</button>
    </form>
  } @else {
    <h3>{{ product.name }}</h3>
    <p>{{ product.price | currency }}</p>
    @if (product.tags) {
      <div class="tags">
        @for (tag of product.tags;track tag.id) {
          <p class="tag">{{ tag.name }}</p>
        }
      </div>
    }
    <button (click)="showDetail(product.id)">show details</button>
    <button (click)="deleteProduct(product.id)">Delete {{ product.name }}</button>
    <button (click)="toggleEditForm()" [disabled]="isEditButtonDisabled">Edit {{ product.name }}</button>
  }
</div>
